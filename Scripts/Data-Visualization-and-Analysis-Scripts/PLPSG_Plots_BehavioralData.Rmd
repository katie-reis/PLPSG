---
title: "PLPSG_Plots_BehavioralData"
output: html_document
date: '2022-10-05'
---

Some notes about the study:
This is a file that will read in (1) Perceptual learning behavioral data, (2) Sleep statistic data (including spindle data), (3) demographic data.
This project was performed under Katie Reis in the APEX Lab at UChicago. 64 electrode slim-electrode EEG (BrainVision) was used to sleep score
We followed AASM guidelines in sleep scoring and used Visbrain Sleep gui to score. 
Pre-test was given at 9am, immediately followed by training and post-test 1. 
Post-test 2 was given immediately prior to sleep at 2:30pm, sleep (or wake) occurred from 3-4:30pm, and then post-test 3 was performed at 5pm
Post-test 4 was performed at 9pm. 
80 words we used for each test, and 300 words were used for training. Words were randomized across tests for each subject. 
Subjects did not leave the lab for the duration of the study. Wake subjects could not listen to audio for the 3-4:30pm block

### import packages
```{r, message=FALSE}
library(ggpubr) #needed for arranging multiple plots and making plots 
library(ggplot2)
library(rlang)
library(dplyr) 
```

### import data files
```{r, message = FALSE}
source("PLPSG_ImportData.R")

# filter out subjects who didn't learn (subjects 134, 141, 142)
PLPSG_sleep_stats_wider = subset(PLPSG_sleep_stats_wider, Subject != '134' & Subject != '141' & Subject != '142')
PLPSG_sleep_stats_longer = subset(PLPSG_sleep_stats_longer, Subject != '134' & Subject != '141' & Subject != '142')

```

### visualize with a boxplot the PLPSG behavioral data all tests
```{r}
ggboxplot(PLPSG_sleep_stats_longer, 
          x = "block", 
          y = "score", 
          color = "condition", 
          add = "jitter") +
  scale_color_manual(values = c("sleep" = "deepskyblue4", "wake" = "indianred3"))

```

### line plot of PLPSG performance across tests (sleep vs wake)
```{r}
plot_sleep = ggplot(data = subset(PLPSG_sleep_stats_longer, condition == "sleep")) + 
  aes(x = block, y = score, group = Subject, color = Subject,
      na.rm = TRUE) + 
  ylim(0.1,0.65) +
  xlab("block") + 
  ylab("performance") +
  theme(axis.title.x = element_text(size=9), axis.title.y = element_text(size=9)) +
  ggtitle("Sleep") +
  geom_line()

plot_wake = ggplot(data = subset(PLPSG_sleep_stats_longer, condition == "wake")) + 
  aes(x = block, y = score, group = Subject, color = Subject,
      na.rm = TRUE) +
  ylim(0.1,0.65) +
  xlab("block") + 
  ylab("performance") +
  theme(axis.title.x = element_text(size=9), axis.title.y = element_text(size=9)) +
  ggtitle("Wake") + 
  geom_line()

figure <- ggarrange(plot_sleep, plot_wake,
                    labels = c("A", "B"),
                    ncol = 1, nrow = 2)
figure
```
```{r}
# Define the flexible plot creation function
create_plot <- function(condition_expr, title) {
  filtered_data <- PLPSG_sleep_stats_longer %>%
    filter(!!parse_expr(condition_expr))  # Use parse_expr to evaluate the condition
  
  ggplot(data = filtered_data) +
    aes(x = block, y = score, group = Subject, color = Subject, na.rm = TRUE) +
    coord_cartesian(ylim = c(0.1, 0.65)) +  # Preserve out-of-range data
    xlab("block") +
    ylab("score") +
    ggtitle(title) +
    geom_line() +
    theme_minimal() +
    theme(
      axis.title.x = element_text(size = 9),
      axis.title.y = element_text(size = 9),
      plot.title = element_text(size = 10),
      legend.text = element_text(size = 5),
      legend.title = element_text(size = 7),
      legend.key.size = unit(0.25, "cm")
    ) +
    guides(color = guide_legend(ncol = 2))
}

# Create plot1 to plot8 with specific conditions
plot1 <- create_plot(
  "condition == 'sleep' & loss > 0 & recovery > 0", 
  "Sleep - loss & recovery"
)

plot2 <- create_plot(
  "condition == 'wake' & loss > 0 & recovery > 0", 
  "Wake - loss & recovery"
)

plot3 <- create_plot(
  "condition == 'sleep' & loss < 0 & recovery > 0", 
  "Sleep - no loss & recovery"
)

plot4 <- create_plot(
  "condition == 'wake' & loss < 0 & recovery > 0", 
  "Wake - no loss & recovery"
)

plot5 <- create_plot(
  "condition == 'sleep' & loss > 0 & recovery < 0", 
  "Sleep - loss & no recovery"
)

plot6 <- create_plot(
  "condition == 'wake' & loss > 0 & recovery < 0", 
  "Wake - loss & no recovery"
)

plot7 <- create_plot(
  "condition == 'sleep' & loss < 0 & recovery < 0", 
  "Sleep - no loss & no recovery"
)

plot8 <- create_plot(
  "condition == 'wake' & loss < 0 & recovery < 0", 
  "Wake - no loss & no recovery"
)

# Arrange the plots in a grid
figure <- ggarrange(
  plot1, plot2, plot3, plot4, 
  plot5, plot6, plot7, plot8, 
  labels = c("A", "B", "C", "D", "E", "F", "G", "H"), 
  ncol = 2, nrow = 4
)

figure



```

### plots individually
```{r}
plot1
plot2
plot3
plot4
plot5
plot6
plot7
plot8


```

### look at these plots a little more in depth 
```{r}

plot9 = create_plot(
  "condition == 'sleep' & loss > 0 & (recovery > 0 | longtermrecovery > 0)", 
  "Sleep - loss & recovery OR delayed recovery "
)
plot10 = create_plot(
  "condition == 'wake' & loss > 0 & (recovery > 0 | longtermrecovery > 0)", 
  "Wake - loss & recovery OR delayed recovery"
)
plot11 = create_plot(
  "condition == 'sleep' & loss > 0 & (recovery > 0 & longtermrecovery > 0)", 
  "Sleep - loss & recovery & delayed recovery"
)
plot12 = create_plot(
  "condition == 'wake' & loss > 0 & (recovery > 0 & longtermrecovery > 0)", 
  "Wake - loss & recovery & delayed recovery"
)
plot13 = create_plot(
  "condition == 'sleep' & loss > 0 & (recovery > 0 & longtermrecovery < 0)", 
  "Sleep - loss & recovery & no delayed recovery"
)
plot14 = create_plot(
  "condition == 'wake' & loss > 0 & (recovery > 0 & longtermrecovery < 0)", 
  "Wake - loss & recovery & no delayed recovery"
)
plot15 = create_plot(
  "condition == 'sleep' & loss > 0 & (recovery < 0 & longtermrecovery > 0)", 
  "sleep - loss & no recovery & delayed recovery"
)
plot16 = create_plot(
  "condition == 'wake' & loss > 0 & (recovery < 0 & longtermrecovery > 0)", 
  "Wake - loss & no recovery & delayed recovery"
)
plot17 = create_plot(
  "condition == 'sleep' & loss > 0 & (recovery < 0 & longtermrecovery < 0)", 
  "sleep - loss & no recovery & no delayed recovery"
)
plot18 = create_plot(
  "condition == 'wake' & loss > 0 & (recovery < 0 & longtermrecovery < 0)", 
  "Wake - loss & no recovery & no delayed recovery"
)

ggarrange(plot11,plot12,plot13,plot14,
          ncol=2,nrow=2)
ggarrange(plot15,plot16,plot17,plot18,
          nrow=2,ncol=2)
```
#plot individually
```{r}

plot9
plot10
plot11
plot12
plot13
plot14
plot15
plot16
plot17
plot18


```

#distinguish based on maintenance now too
```{r}

plot19 = create_plot(
  "condition == 'sleep' & loss > 0 & (recovery > 0 & longtermrecovery > 0 & maintenance >= 0)", 
  "Sleep - loss & recovery & LTR & maintenance"
)
plot20 = create_plot(
  "condition == 'wake' & loss > 0 & (recovery > 0 & longtermrecovery > 0 & maintenance >= 0)", 
  "Wake - loss & recovery & LTR & maintenance"
)

plot21 = create_plot(
  "condition == 'sleep' & loss > 0 & (recovery > 0 & longtermrecovery > 0 & maintenance < 0)", 
  "Sleep - loss & recovery & LTR & no maintenance"
)
plot22 = create_plot(
  "condition == 'wake' & loss > 0 & (recovery > 0 & longtermrecovery > 0 & maintenance < 0)", 
  "Wake - loss & recovery & LTR & no maintenance"
)

plot23 = create_plot(
  "condition == 'sleep' & loss > 0 & (recovery > 0 & longtermrecovery <= 0 & maintenance >= 0)", 
  "Sleep - loss & recovery & no LTR & maintenance"
)
plot24 = create_plot(
  "condition == 'wake' & loss > 0 & (recovery > 0 & longtermrecovery <= 0 & maintenance >= 0)", 
  "Wake - loss & recovery & no LTR & maintenance"
)
plot25 = create_plot(
  "condition == 'sleep' & loss > 0 & (recovery > 0 & longtermrecovery <= 0 & maintenance < 0)", 
  "Sleep - loss & recovery & no LTR & no maintenance"
)
plot26 = create_plot(
  "condition == 'wake' & loss > 0 & (recovery > 0 & longtermrecovery <= 0 & maintenance < 0)", 
  "Wake - loss & recovery & no LTR & no maintenance"
)

plot27 = create_plot(
  "condition == 'sleep' & loss > 0 & (recovery <= 0 & longtermrecovery > 0 & maintenance >= 0)", 
  "sleep - loss & no recovery & LTR & maintenance"
)
plot28 = create_plot(
  "condition == 'wake' & loss > 0 & (recovery <= 0 & longtermrecovery > 0 & maintenance >= 0)", 
  "Wake - loss & no recovery & LTR & maintenance"
)

plot29 = create_plot(
  "condition == 'sleep' & loss > 0 & (recovery <= 0 & longtermrecovery > 0 & maintenance < 0)", 
  "sleep - loss & no recovery & LTR & no maintenance"
)
plot30 = create_plot(
  "condition == 'wake' & loss > 0 & (recovery <= 0 & longtermrecovery > 0 & maintenance < 0)", 
  "Wake - loss & no recovery & LTR & no maintenance"
)

plot31 = create_plot(
  "condition == 'sleep' & loss > 0 & (recovery <= 0 & longtermrecovery <= 0 & maintenance >= 0)", 
  "sleep - loss & no recovery & no LTR & maintenance"
)
plot32 = create_plot(
  "condition == 'wake' & loss > 0 & (recovery <= 0 & longtermrecovery <= 0 & maintenance >= 0)", 
  "Wake - loss & no recovery & no LTR & maintenance"
)

plot33 = create_plot(
  "condition == 'sleep' & loss > 0 & (recovery <= 0 & longtermrecovery <= 0 & maintenance < 0)", 
  "sleep - loss & no recovery & no LTR & no maintenance"
)
plot34 = create_plot(
  "condition == 'wake' & loss > 0 & (recovery <= 0 & longtermrecovery <= 0 & maintenance < 0)", 
  "Wake - loss & no recovery & no LTR & no maintenance"
)

ggarrange(plot19,plot20,plot21,plot22,
          ncol=2,nrow=2)
ggarrange(plot23,plot24,plot25,plot26,
          nrow=2,ncol=2)
ggarrange(plot27,plot28,plot29,plot30,
          ncol=2,nrow=2)
ggarrange(plot31,plot32,plot33,plot34,
          nrow=2,ncol=2)
```


### another way to look at this same data - plot learning, loss, recovery, retention on the x axis
```{r}
difference_scores = PLPSG_sleep_stats_wider %>% pivot_longer(cols = c("learning", "loss","recovery","maintenance"), 
                                                      names_to = "phase",
                                                      values_to = "performance_change")

plot_sleep = ggplot(data = subset(difference_scores, condition == "sleep")) + 
  aes(x = fct_inorder(phase), y = performance_change, na.rm = TRUE) +
  xlab("phase") + 
  ylab("performance change") +
  theme(axis.title.x = element_text(size=9), axis.title.y = element_text(size=9)) +
  ggtitle("Sleep") +
  geom_line(aes(group = subject)) +
  stat_summary(fun.data = "mean_cl_boot",
               geom = "crossbar",
               colour = "red",
               width = 0.2) 

plot_wake = ggplot(data = subset(difference_scores, condition == "wake")) + 
  aes(x = fct_inorder(phase), y = performance_change, na.rm = TRUE) +
  xlab("phase") + 
  ylab("performance change") +
  theme(axis.title.x = element_text(size=9), axis.title.y = element_text(size=9)) +
  ggtitle("Wake") + 
  geom_line(aes(group = subject)) + 
  stat_summary(fun.data = "mean_cl_boot",
               geom = "crossbar",
               colour = "red",
               width = 0.2) 

figure <- ggarrange(plot_sleep, plot_wake,
                    labels = c("A", "B"),
                    ncol = 2, nrow = 1)
figure
```

### histogram plots of learning
```{r, message= FALSE}
learningplot = ggplot(PLPSG_sleep_stats_wider,
  aes(x = learning,
      fill = condition)) +
  ggtitle("Learning (Block 3 - Block 1)") +
    xlim(-0.15,.45) +
  geom_histogram(alpha = 0.5, position = "identity", bins = 30) + 
  scale_fill_manual(values=c("deepskyblue4", "indianred3"))

learningplot

x1 = PLPSG_sleep_stats_wider$learning[PLPSG_sleep_stats_wider$condition == "sleep"]
x2 = PLPSG_sleep_stats_wider$learning[PLPSG_sleep_stats_wider$condition == "wake"]
par(mfrow=c(2,1))
 
#Make the plot
par(mar=c(0,5,3,3))
hist(x1 , main="" , xlim=c(-0.2, 0.45), ylab="Count: sleep", xlab="", ylim=c(0,4) , xaxt="n", las=1 , col="deepskyblue4", breaks=12)
par(mar=c(5,5,0,3))
hist(x2 , main="" , xlim=c(-0.2, 0.45), ylab="Count: wake", xlab="Learning", ylim=c(4,0) , las=1 , col="indianred3"  , breaks=12)
```

### histogram plots of loss
```{r, message= FALSE}
lossplot = ggplot(PLPSG_sleep_stats_wider,
  aes(x = loss,
      fill = condition)) +
  ggtitle("Loss (Block 4 - Block 3)") +
    xlim(-0.15,.45) +
  geom_histogram(alpha = 0.5, position = "identity", bins = 29) + 
  scale_fill_manual(values=c("deepskyblue4", "indianred3"))

lossplot

x1 = PLPSG_sleep_stats_wider$loss[PLPSG_sleep_stats_wider$condition == "sleep"]
x2 = PLPSG_sleep_stats_wider$loss[PLPSG_sleep_stats_wider$condition == "wake"]
par(mfrow=c(2,1))
 
#Make the plot
par(mar=c(0,5,3,3))
hist(x1 , main="" , xlim=c(-0.2, 0.45), ylab="Count: sleep", xlab="", ylim=c(0,6) , xaxt="n", las=1 , col="deepskyblue4", breaks=12)
par(mar=c(5,5,0,3))
hist(x2 , main="" , xlim=c(-0.2, 0.45), ylab="Count: wake", xlab="Loss", ylim=c(6,0) , las=1 , col="indianred3"  , breaks=12)
```

### histogram plots of recovery
```{r, message= FALSE}
recoveryplot = ggplot(PLPSG_sleep_stats_wider,
  aes(x = recovery,
      fill = condition)) +
  ggtitle("Recovery (Block 5 - Block 4)") +
    xlim(-0.15,.45) +
  geom_histogram(alpha = 0.5, position = "identity", bins = 30) + 
  scale_fill_manual(values=c("deepskyblue4", "indianred3"))

recoveryplot

x1 = PLPSG_sleep_stats_wider$recovery[PLPSG_sleep_stats_wider$condition == "sleep"]
x2 = PLPSG_sleep_stats_wider$recovery[PLPSG_sleep_stats_wider$condition == "wake"]
par(mfrow=c(2,1))
 
#Make the plot
par(mar=c(0,5,3,3))
hist(x1 , main="" , xlim=c(-0.2, 0.45), ylab="Count: sleep", xlab="", ylim=c(0,6) , xaxt="n", las=1 , col="deepskyblue4", breaks=12)
par(mar=c(5,5,0,3))
hist(x2 , main="" , xlim=c(-0.2, 0.45), ylab="Count: wake", xlab="Recovery", ylim=c(6,0) , las=1 , col="indianred3"  , breaks=12)
```

### histogram plots of maintenance
```{r, message= FALSE}
maintenanceplot = ggplot(PLPSG_sleep_stats_wider,
  aes(x = maintenance,
      fill = condition)) +
  ggtitle("Maintenance (Block 6 - Block 5)") +
    xlim(-0.15,.45) +
  geom_histogram(alpha = 0.5, position = "identity", bins = 30) + 
  scale_fill_manual(values=c("deepskyblue4", "indianred3"))

maintenanceplot

x1 = PLPSG_sleep_stats_wider$maintenance[PLPSG_sleep_stats_wider$condition == "sleep"]
x2 = PLPSG_sleep_stats_wider$maintenance[PLPSG_sleep_stats_wider$condition == "wake"]
par(mfrow=c(2,1))
 
#Make the plot
par(mar=c(0,5,3,3))
hist(x1 , main="" , xlim=c(-0.2, 0.45), ylab="Count: sleep", xlab="", ylim=c(0,7) , xaxt="n", las=1 , col="deepskyblue4", breaks=12)
par(mar=c(5,5,0,3))
hist(x2 , main="" , xlim=c(-0.2, 0.45), ylab="Count: wake", xlab="Maintenance", ylim=c(7,0) , las=1 , col="indianred3"  , breaks=12)
```

### histogram plots of learning long term recovery
```{r, message= FALSE}
ltrplot = ggplot(PLPSG_sleep_stats_wider,
  aes(x = longtermrecovery,
      fill = condition)) +
  ggtitle("Long term recovery (Block 6 - Block 4)") +
    xlim(-0.15,.45) +
  geom_histogram(alpha = 0.5, position = "identity", bins = 30) + 
  scale_fill_manual(values=c("deepskyblue4", "indianred3"))

ltrplot

x1 = PLPSG_sleep_stats_wider$longtermrecovery[PLPSG_sleep_stats_wider$condition == "sleep"]
x2 = PLPSG_sleep_stats_wider$longtermrecovery[PLPSG_sleep_stats_wider$condition == "wake"]
par(mfrow=c(2,1))
 
#Make the plot
par(mar=c(0,5,3,3))
hist(x1 , main="" , xlim=c(-0.2, 0.45), ylab="Count: sleep", xlab="", ylim=c(0,7) , xaxt="n", las=1 , col="deepskyblue4", breaks=12)
par(mar=c(5,5,0,3))
hist(x2 , main="" , xlim=c(-0.2, 0.45), ylab="Count: wake", xlab="Long term recovery", ylim=c(7,0) , las=1 , col="indianred3"  , breaks=12)
```

### violin plots of protection (block6 - block3)
```{r, message= FALSE}
protectiveplot = ggplot(PLPSG_sleep_stats_wider,
  aes(x = protective,
      fill = condition)) +
  ggtitle("Protection (Block 6 - Block 3)") +
    xlim(-0.4,.25) +
  geom_histogram(alpha = 0.5, position = "identity", bins = 30) + 
  scale_fill_manual(values=c("deepskyblue4", "indianred3"))

protectiveplot

x1 = PLPSG_sleep_stats_wider$protective[PLPSG_sleep_stats_wider$condition == "sleep"]
x2 = PLPSG_sleep_stats_wider$protective[PLPSG_sleep_stats_wider$condition == "wake"]
par(mfrow=c(2,1))
 
#Make the plot
par(mar=c(0,5,3,3))
hist(x1 , main="" , xlim=c(-0.4, 0.25), ylab="Count: sleep", xlab="", ylim=c(0,4) , xaxt="n", las=1 , col="deepskyblue4", breaks=12)
par(mar=c(5,5,0,3))
hist(x2 , main="" , xlim=c(-0.4, 0.25), ylab="Count: wake", xlab="Protective", ylim=c(4,0) , las=1 , col="indianred3", breaks=12)
```

### violin plots of learning
```{r, message= FALSE}
learningplot = ggplot(PLPSG_sleep_stats_wider,
  aes(y = learning,
      x = condition)) +
  ggtitle("Learning (Block 3 - Block 1") +
  geom_violin() + 
    ylim(-0.15,.45) +
  geom_dotplot(binaxis='y', stackdir='center', dotsize=1)  +
  stat_summary(fun.data = "mean_cl_boot",
               geom = "crossbar",
               colour = "red",
               width = 0.2)

learningplot
```

### violin plot of PLPSG loss (post-test2 - post-test1)
```{r, message= FALSE}
lossplot = ggplot(PLPSG_sleep_stats_wider,
  aes(y = loss,
      x = condition)) +
  ggtitle("Loss (Block 4 - Block 3") +
  geom_violin() + 
  geom_dotplot(binaxis='y', stackdir='center', dotsize=1)  +
  stat_summary(fun.data = "mean_cl_boot",
               geom = "crossbar",
               colour = "red",
               width = 0.2)

lossplot
```

### violin plot of PLPSG recovery (post-test3 - post-test2)
```{r, message= FALSE}
recoveryplot = ggplot(PLPSG_sleep_stats_wider,
  aes(y = recovery,
      x = condition)) +
  ggtitle("Recovery (block 5 - block 4") +
  geom_violin() + 
  geom_dotplot(binaxis='y', stackdir='center', dotsize=1)  +
  stat_summary(fun.data = "mean_cl_boot",
               geom = "crossbar",
               colour = "red",
               width = 0.2)

recoveryplot
```

### violin plot of PLPSG maintenance (post-test4 - post-test3)
```{r, message= FALSE}
maintenanceplot = ggplot(PLPSG_sleep_stats_wider,
  aes(y = maintenance,
      x = condition)) +
  ggtitle("Maintenance (block 6 - block 5)") +
  geom_violin() + 
  geom_dotplot(binaxis='y', stackdir='center', dotsize=1)  +
  stat_summary(fun.data = "mean_cl_boot",
               geom = "crossbar",
               colour = "red",
               width = 0.2)

maintenanceplot
```

### violin plots of protective effect (last post-test - first post-test)
```{r, message= FALSE, warning = FALSE}
protectiveplot = ggplot(PLPSG_sleep_stats_wider,
  aes(y = protective,
      x = condition)) +
  ggtitle("Protective (block 6 - block 3)") +
  geom_violin() + 
  ylim(-.2,.175) +
  geom_dotplot(binaxis='y', stackdir='center', dotsize=1)  +
  stat_summary(fun.data = "mean_cl_boot",
               geom = "crossbar",
               colour = "red",
               width = 0.2)

protectiveplot
```
### violin plots of long term recovery effect (last post-test - second post-test)
```{r, message= FALSE, warning = FALSE}
LTRplot = ggplot(PLPSG_sleep_stats_wider,
  aes(y = longtermrecovery,
      x = condition)) +
  ggtitle("Long Term Recovery (block 6 - block 4)") +
  geom_violin() + 
  ylim(-.2,.175) +
  geom_dotplot(binaxis='y', stackdir='center', dotsize=1)  +
  stat_summary(fun.data = "mean_cl_boot",
               geom = "crossbar",
               colour = "red",
               width = 0.2)

LTRplot

```
### violin plots of retention effect (last post-test - pretest)
```{r, message= FALSE, warning = FALSE}
retentionplot = ggplot(PLPSG_sleep_stats_wider,
  aes(y = retention,
      x = condition)) +
  ggtitle("Retention (block 6 - block 1)") +
  geom_violin() + 
  ylim(-.1,.3) +
  geom_dotplot(binaxis='y', stackdir='center', dotsize=1)  +
  stat_summary(fun.data = "mean_cl_boot",
               geom = "crossbar",
               colour = "red",
               width = 0.2)

retentionplot

```
###arrange plots side by side
```{r}


figure1 = ggarrange(learningplot, lossplot, recoveryplot, maintenanceplot,
                    labels = c("A", "B", "C", "D"),
                    nrow = 2, ncol=2)
figure1

figure2 = ggarrange(protectiveplot, LTRplot, retentionplot,
                    labels = c("E", "F", "G"),
                    nrow = 2, ncol=2)
figure2

```

### histogram of protective effect (sleep vs wake)
```{r, message= FALSE}
sleep_plot_protective = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep"),
  aes(x = protective)) +
  ggtitle("Protective Effect - sleep") +
  geom_histogram() 

wake_plot_protective = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "wake"),
  aes(x = protective)) +
  ggtitle("Protective Effect - wake") +
  geom_histogram() 

figure = ggarrange(sleep_plot_protective, wake_plot_protective,
                    labels = c("A", "B"),
                    ncol = 2, nrow = 1)
figure
```


### violin plot of the difference between last post-test and pre-test ("retention"), next to learning plots
```{r, message= FALSE}
learning_katie_collected <- ggplot(PLPSG_sleep_stats_wider,
  aes(y = learning,
      x = condition)) +
  ggtitle("post-test1  -  pre-test") +
  geom_violin() + 
  ylim(-.1,.3) +
  geom_dotplot(binaxis='y', stackdir='center', dotsize=1)  +
  stat_summary(fun.data = "mean_cl_boot",
               geom = "crossbar",
               colour = "red",
               width = 0.2)

retention_katie_collected <- ggplot(PLPSG_sleep_stats_wider,
  aes(y = retention, 
      x = condition)) +
  ggtitle("Last-post-test  -  pre-test") +
  geom_violin() +
  ylim(-.1,.3) +
  geom_dotplot(binaxis='y', stackdir='center', dotsize=1) +
  stat_summary(fun.data = "mean_cl_boot",
               geom = "crossbar",
               colour = "red",
               width = 0.2)

figure <- ggarrange(learning_katie_collected, retention_katie_collected,
                    labels = c("A", "B"),
                    ncol = 2, nrow = 1)
figure
```

### median split plots 
```{r, message= FALSE}
#learning plot
learning_median_sleep <- ggplot(subset(PLPSG_sleep_stats_wider, condition == "sleep"),
  aes(y = learning,
      x = above_median)) +
  ggtitle("learning sleep") +
  geom_violin() + 
  ylim(0.0,.3) +
  geom_dotplot(binaxis='y', stackdir='center', dotsize=1)  +
  stat_summary(fun.data = "mean_cl_boot",
               geom = "crossbar",
               colour = "red",
               width = 0.2)

learning_median_wake <- ggplot(subset(PLPSG_sleep_stats_wider, condition == "wake"),
  aes(y = learning, 
      x = above_median)) +
  ggtitle("learning wake") +
  geom_violin() +
  ylim(0.0,.3) +
  geom_dotplot(binaxis='y', stackdir='center', dotsize=1) +
  stat_summary(fun.data = "mean_cl_boot",
               geom = "crossbar",
               colour = "red",
               width = 0.2)

figure <- ggarrange(learning_median_sleep, learning_median_wake,
                    labels = c("A", "B"),
                    ncol = 2, nrow = 1)
figure

#protective plot 
protective_median_sleep <- ggplot(subset(PLPSG_sleep_stats_wider, condition == "sleep"),
  aes(y = protective,
      x = above_median)) +
  ggtitle("protective sleep") +
  geom_violin() + 
  ylim(-.225,0.05) +
  geom_dotplot(binaxis='y', stackdir='center', dotsize=1)  +
  stat_summary(fun.data = "mean_cl_boot",
               geom = "crossbar",
               colour = "red",
               width = 0.2)

protective_median_wake <- ggplot(subset(PLPSG_sleep_stats_wider, condition == "wake"),
  aes(y = protective, 
      x = above_median)) +
  ggtitle("protective wake") +
  geom_violin() +
  ylim(-.225,0.05) +
  geom_dotplot(binaxis='y', stackdir='center', dotsize=1) +
  stat_summary(fun.data = "mean_cl_boot",
               geom = "crossbar",
               colour = "red",
               width = 0.2)

figure <- ggarrange(protective_median_sleep, protective_median_wake,
                    labels = c("A", "B"),
                    ncol = 2, nrow = 1)
figure

#consolidation plot
consolidation_median_sleep <- ggplot(subset(PLPSG_sleep_stats_wider, condition == "sleep"),
  aes(y = consolidation,
      x = above_median)) +
  ggtitle("consolidation sleep") +
  geom_violin() + 
  ylim(-15,40) +
  geom_dotplot(binaxis='y', stackdir='center', dotsize=1)  +
  stat_summary(fun.data = "mean_cl_boot",
               geom = "crossbar",
               colour = "red",
               width = 0.2)

consolidation_median_wake <- ggplot(subset(PLPSG_sleep_stats_wider, condition == "wake"),
  aes(y = consolidation, 
      x = above_median)) +
  ggtitle("consolidation wake") +
  geom_violin() +
  ylim(-15,40) +
  geom_dotplot(binaxis='y', stackdir='center', dotsize=1) +
  stat_summary(fun.data = "mean_cl_boot",
               geom = "crossbar",
               colour = "red",
               width = 0.2)

figure <- ggarrange(consolidation_median_sleep, consolidation_median_wake,
                    labels = c("A", "B"),
                    ncol = 2, nrow = 1)
figure
```

### undergrad vs non-undergrad plots 
```{r, message= FALSE}
#for learning
learning_undergrads_sleep <- ggplot(subset(PLPSG_sleep_stats_wider, condition == "sleep"),
  aes(y = learning,
      x = undergrad)) +
  ggtitle("learning sleep") +
  geom_violin() + 
  ylim(0.0,.3) +
  geom_dotplot(binaxis='y', stackdir='center', dotsize=1)  +
  stat_summary(fun.data = "mean_cl_boot",
               geom = "crossbar",
               colour = "red",
               width = 0.2)

learning_undergrads_wake <- ggplot(subset(PLPSG_sleep_stats_wider, condition == "wake"),
  aes(y = learning, 
      x = undergrad)) +
  ggtitle("learning wake") +
  geom_violin() +
  ylim(0.0,.3) +
  geom_dotplot(binaxis='y', stackdir='center', dotsize=1) +
  stat_summary(fun.data = "mean_cl_boot",
               geom = "crossbar",
               colour = "red",
               width = 0.2)

figure <- ggarrange(learning_undergrads_sleep, learning_undergrads_wake,
                    labels = c("A", "B"),
                    ncol = 2, nrow = 1)
figure

#protective plot
protective_undergrads_sleep <- ggplot(subset(PLPSG_sleep_stats_wider, condition == "sleep"),
  aes(y = protective,
      x = undergrad)) +
  ggtitle("protective sleep") +
  geom_violin() + 
  ylim(-.225,0.05) +
  geom_dotplot(binaxis='y', stackdir='center', dotsize=1)  +
  stat_summary(fun.data = "mean_cl_boot",
               geom = "crossbar",
               colour = "red",
               width = 0.2)

protective_undergrads_wake <- ggplot(subset(PLPSG_sleep_stats_wider, condition == "wake"),
  aes(y = protective, 
      x = undergrad)) +
  ggtitle("protective wake") +
  geom_violin() +
  ylim(-.225,0.05) +
  geom_dotplot(binaxis='y', stackdir='center', dotsize=1) +
  stat_summary(fun.data = "mean_cl_boot",
               geom = "crossbar",
               colour = "red",
               width = 0.2)

figure <- ggarrange(protective_undergrads_sleep, protective_undergrads_wake,
                    labels = c("A", "B"),
                    ncol = 2, nrow = 1)
figure

#consolidation plot 
consolidation_undergrads_sleep <- ggplot(subset(PLPSG_sleep_stats_wider, condition == "sleep"),
  aes(y = consolidation,
      x = undergrad)) +
  ggtitle("consolidation sleep") +
  geom_violin() + 
  ylim(-15,40) +
  geom_dotplot(binaxis='y', stackdir='center', dotsize=1)  +
  stat_summary(fun.data = "mean_cl_boot",
               geom = "crossbar",
               colour = "red",
               width = 0.2)

consolidation_undergrads_wake <- ggplot(subset(PLPSG_sleep_stats_wider, condition == "wake"),
  aes(y = consolidation, 
      x = undergrad)) +
  ggtitle("consolidation wake") +
  geom_violin() +
  ylim(-15,40) +
  geom_dotplot(binaxis='y', stackdir='center', dotsize=1) +
  stat_summary(fun.data = "mean_cl_boot",
               geom = "crossbar",
               colour = "red",
               width = 0.2)

figure <- ggarrange(consolidation_undergrads_sleep, consolidation_undergrads_wake,
                    labels = c("A", "B"),
                    ncol = 2, nrow = 1)
figure
```

### use a violin plot to see if sleep and wake subjects differ in block 3 performance
```{r}
#violin plot - block3
ggplot(PLPSG_sleep_stats_wider,
  aes(y = block3,
      x = condition)) +
  ggtitle("block3") +
  geom_violin() + 
  geom_dotplot(binaxis='y', stackdir='center', dotsize=1)  +
  stat_summary(fun.data = "mean_cl_boot",
               geom = "crossbar",
               colour = "red",
               width = 0.2)
```

### Use a violin plot to see if sleep and wake subjects they differ in block 6 performance
```{r}
#violin plot - block6
ggplot(PLPSG_sleep_stats_wider,
  aes(y = block6,
      x = condition)) +
  ggtitle("block6") +
  geom_violin() + 
  geom_dotplot(binaxis='y', stackdir='center', dotsize=1)  +
  stat_summary(fun.data = "mean_cl_boot",
               geom = "crossbar",
               colour = "red",
               width = 0.2)
```

### Use violin plots for consolidation2 (has learning as the denominator instead)
```{r}
ggplot(PLPSG_sleep_stats_wider,
  aes(y = consolidation2,
      x = condition)) +
  ggtitle("Our consolidation") +
  geom_violin() +
  geom_dotplot(binaxis='y', stackdir='center', dotsize=1)  +
  stat_summary(fun.data = "mean_cl_boot",
               geom = "crossbar",
               colour = "red",
               width = 0.2)
```

### remaking plots from the SNAP paper for the PLPSG dataset 
```{r}
temp = PLPSG_sleep_stats_longer %>% filter(
 block == "block1" | block == "block3"
  )

temp["block"][temp["block"] == "block1"] <- "pretest"
temp["block"][temp["block"] == "block3"] <- "posttest1"

temp$condition <- factor(temp$condition)

ggline(temp, x="block",y="score",
       color = "condition", add = "mean_se", 
       position=position_dodge(width = 0.7)) + 
  ylab("Proportion Correct") +
  xlab("Test") +
  labs(colour="Condition") +
  theme(legend.position="right", axis.title = element_text(size = 14)) +
  scale_color_manual(breaks = c("sleep", "wake"),values=c("deepskyblue4", "indianred3"), labels = c("nap", "wake")) +
  scale_x_discrete(labels=c("pretest" = "Pretest", "posttest1" = "Posttest1")) +
  geom_point(aes(x=block, y=score, colour=condition), 
             size=0.7, alpha = 0.5, 
             position=position_jitterdodge(jitter.width = 0.3, dodge.width = 0.7))

```

```{r}
temp = PLPSG_sleep_stats_longer %>% filter(
 block == "block1" | block == "block3" | block == "block4" | block == "block5" | block == "block6"
  )

ggline(temp, x="block",y="score",
       color = "condition", add = "mean_se", 
       position=position_dodge(width = 0.7)) + 
  ylab("Proportion Correct") +
  xlab("Test") +
  labs(colour="Condition") +
  theme(legend.position="right", axis.title = element_text(size = 14)) +
  scale_color_manual(breaks = c("sleep", "wake"),values=c("deepskyblue4", "indianred3"), labels = c("nap", "wake")) +
  scale_x_discrete(labels=c("block1" = "Pretest", "block3" = "Posttest1", "block4" = "Posttest2", "block5" = "Posttest3", "block6" = "Posttest4")) +
  geom_point(aes(x=block, y=score, colour=condition), 
             size=0.7, alpha = 0.5, 
             position=position_jitterdodge(jitter.width = 0.3, dodge.width = 0.7)) 

```
```{r}

temp = PLPSG_sleep_stats_wider 
  

ggviolin(temp, x="condition",y="protective") + 
  ylab("Posttest3 - Posttest1") +
  xlab("Condition") +
  theme(axis.title = element_text(size = 14)) +
  geom_point(aes( y=protective), 
             size=0.5, alpha = 0.5, 
             position=position_jitter(width = 0.07)) + 
  coord_fixed(ratio = 3) + 
  scale_x_discrete(labels=c('nap', 'wake'))


```


### look at the correlation between block 1 and block 3
```{r}
fitboth = lm(as.numeric(block3) ~ as.numeric(block1), subset(PLPSG_sleep_stats_wider))
#for both sleep and wake subjects together
ggplot(data = PLPSG_sleep_stats_wider) + 
  aes(x = as.numeric(block1), y = as.numeric(block3),
      na.rm = TRUE) + 
  xlab("block1") + 
  ylab("block3") +
  theme(axis.title.x = element_text(size=9), axis.title.y = element_text(size=9)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
    geom_label(aes(x = 0.35, y = 0.3),
               hjust = 0, size = 3,
               label = paste("p =", signif(summary(fitboth)$coef[2, 4], 5)),
               inherit.aes = FALSE)

#for just sleep subjects
fitsleep = lm(as.numeric(block3) ~ as.numeric(block1), subset(PLPSG_sleep_stats_wider, condition == "sleep"))

plot_sleep = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(x = as.numeric(block1), y = as.numeric(block3),
      na.rm = TRUE) + 
  xlab("block1") + 
  ylab("block3") +
  ggtitle("sleep") + 
  theme(axis.title.x = element_text(size=9), axis.title.y = element_text(size=9)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
    geom_label(aes(x = 0.3, y = 0.31),
               hjust = 0, size = 3,
               label = paste("p =", signif(summary(fitsleep)$coef[2, 4], 5)),
               inherit.aes = FALSE)

#for just wake subjects
fitwake = lm(as.numeric(block3) ~ as.numeric(block1), subset(PLPSG_sleep_stats_wider, condition == "wake"))

plot_wake = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "wake")) + 
  aes(x = as.numeric(block1), y = as.numeric(block3),
      na.rm = TRUE) + 
  xlab("block1") + 
  ylab("block3") +
  ggtitle("wake") +
  theme(axis.title.x = element_text(size=9), axis.title.y = element_text(size=9)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
    geom_label(aes(x = 0.3, y = 0.25),
               hjust = 0, size = 3,
               label = paste("p =", signif(summary(fitwake)$coef[2, 4], 5)),
               inherit.aes = FALSE) 

figure <- ggarrange(plot_sleep, plot_wake,
                    labels = c("A", "B"),
                    ncol = 2, nrow = 1)
figure
```



### histogram plots of learning (removing people who also don't show loss)
```{r, message= FALSE}
learningplot = ggplot(subset(PLPSG_sleep_stats_wider, loss > 0),
  aes(x = learning,
      fill = condition)) +
  ggtitle("Learning (Block 3 - Block 1)") +
    xlim(-0.15,.45) +
  geom_histogram(alpha = 0.5, position = "identity", bins = 30) + 
  scale_fill_manual(values=c("deepskyblue4", "indianred3"))

learningplot

x1 = PLPSG_sleep_stats_wider$learning[PLPSG_sleep_stats_wider$condition == "sleep" & PLPSG_sleep_stats_wider$loss > 0]
x2 = PLPSG_sleep_stats_wider$learning[PLPSG_sleep_stats_wider$condition == "wake" & PLPSG_sleep_stats_wider$loss > 0]
par(mfrow=c(2,1))
 
#Make the plot
par(mar=c(0,5,3,3))
hist(x1 , main="" , xlim=c(-0.2, 0.45), ylab="Count: sleep", xlab="", ylim=c(0,4) , xaxt="n", las=1 , col="deepskyblue4", breaks=12)
par(mar=c(5,5,0,3))
hist(x2 , main="" , xlim=c(-0.2, 0.45), ylab="Count: wake", xlab="Learning (Only for subjects Loss > 0)", ylim=c(4,0) , las=1 , col="indianred3"  , breaks=12)
```


### histogram plots of loss (removing people who also don't show loss)
```{r, message= FALSE}
lossplot = ggplot(subset(PLPSG_sleep_stats_wider, loss > 0),
  aes(x = loss,
      fill = condition)) +
  ggtitle("Loss (Block 4 - Block 3)") +
    xlim(-0.15,.45) +
  geom_histogram(alpha = 0.5, position = "identity", bins = 30) + 
  scale_fill_manual(values=c("deepskyblue4", "indianred3"))

lossplot

x1 = PLPSG_sleep_stats_wider$loss[PLPSG_sleep_stats_wider$condition == "sleep" & PLPSG_sleep_stats_wider$loss > 0]
x2 = PLPSG_sleep_stats_wider$loss[PLPSG_sleep_stats_wider$condition == "wake" & PLPSG_sleep_stats_wider$loss > 0]
par(mfrow=c(2,1))
 
#Make the plot
par(mar=c(0,5,3,3))
hist(x1 , main="" , xlim=c(-0.2, 0.45), ylab="Count: sleep", xlab="", ylim=c(0,4) , xaxt="n", las=1 , col="deepskyblue4", breaks=10)
par(mar=c(5,5,0,3))
hist(x2 , main="" , xlim=c(-0.2, 0.45), ylab="Count: wake", xlab="Loss (Only for subjects Loss > 0)", ylim=c(4,0) , las=1 , col="indianred3"  , breaks=10)
```



### histogram plots of recovery (removing people who also don't show loss)
```{r, message= FALSE}
recoveryplot = ggplot(subset(PLPSG_sleep_stats_wider, loss > 0),
  aes(x = recovery,
      fill = condition)) +
  ggtitle("Recovery (Block 5 - Block 4)") +
    xlim(-0.15,.45) +
  geom_histogram(alpha = 0.5, position = "identity", bins = 30) + 
  scale_fill_manual(values=c("deepskyblue4", "indianred3"))

recoveryplot

x1 = PLPSG_sleep_stats_wider$recovery[PLPSG_sleep_stats_wider$condition == "sleep" & PLPSG_sleep_stats_wider$loss > 0]
x2 = PLPSG_sleep_stats_wider$recovery[PLPSG_sleep_stats_wider$condition == "wake" & PLPSG_sleep_stats_wider$loss > 0]
par(mfrow=c(2,1))
 
#Make the plot
par(mar=c(0,5,3,3))
hist(x1 , main="" , xlim=c(-0.2, 0.45), ylab="Count: sleep", xlab="", ylim=c(0,4) , xaxt="n", las=1 , col="deepskyblue4", breaks=12)
par(mar=c(5,5,0,3))
hist(x2 , main="" , xlim=c(-0.2, 0.45), ylab="Count: wake", xlab="Recovery (Only for subjects Loss > 0)", ylim=c(4,0) , las=1 , col="indianred3"  , breaks=12)
```


### histogram plots of maintenance (removing people who also don't show loss)
```{r, message= FALSE}
maintenanceplot = ggplot(subset(PLPSG_sleep_stats_wider, loss > 0),
  aes(x = maintenance,
      fill = condition)) +
  ggtitle("Maintenance (Block 6 - Block 5)") +
    xlim(-0.15,.45) +
  geom_histogram(alpha = 0.5, position = "identity", bins = 30) + 
  scale_fill_manual(values=c("deepskyblue4", "indianred3"))

maintenanceplot

x1 = PLPSG_sleep_stats_wider$maintenance[PLPSG_sleep_stats_wider$condition == "sleep" & PLPSG_sleep_stats_wider$loss > 0]
x2 = PLPSG_sleep_stats_wider$maintenance[PLPSG_sleep_stats_wider$condition == "wake" & PLPSG_sleep_stats_wider$loss > 0]
par(mfrow=c(2,1))
 
#Make the plot
par(mar=c(0,5,3,3))
hist(x1 , main="" , xlim=c(-0.2, 0.45), ylab="Count: sleep", xlab="", ylim=c(0,4) , xaxt="n", las=1 , col="deepskyblue4", breaks=12)
par(mar=c(5,5,0,3))
hist(x2 , main="" , xlim=c(-0.2, 0.45), ylab="Count: wake", xlab="Maintenance (Only for subjects Loss > 0)", ylim=c(4,0) , las=1 , col="indianred3"  , breaks=12)
```


### histogram plots of longtermrecovery (removing people who also don't show loss)
```{r, message= FALSE}
ltrplot = ggplot(subset(PLPSG_sleep_stats_wider, loss > 0),
  aes(x = longtermrecovery,
      fill = condition)) +
  ggtitle("Long Term Recovery (Block 6 - Block 4)") +
    xlim(-0.15,.45) +
  geom_histogram(alpha = 0.5, position = "identity", bins = 30) + 
  scale_fill_manual(values=c("deepskyblue4", "indianred3"))

ltrplot

x1 = PLPSG_sleep_stats_wider$longtermrecovery[PLPSG_sleep_stats_wider$condition == "sleep" & PLPSG_sleep_stats_wider$loss > 0]
x2 = PLPSG_sleep_stats_wider$longtermrecovery[PLPSG_sleep_stats_wider$condition == "wake" & PLPSG_sleep_stats_wider$loss > 0]
par(mfrow=c(2,1))
 
#Make the plot
par(mar=c(0,5,3,3))
hist(x1 , main="" , xlim=c(-0.2, 0.45), ylab="Count: sleep", xlab="", ylim=c(0,4) , xaxt="n", las=1 , col="deepskyblue4", breaks=12)
par(mar=c(5,5,0,3))
hist(x2 , main="" , xlim=c(-0.2, 0.45), ylab="Count: wake", xlab="Long term recovery (Only for subjects Loss > 0)", ylim=c(4,0) , las=1 , col="indianred3"  , breaks=12)
```


### histogram plots of protective (removing people who also don't show loss)
```{r, message= FALSE}
protectiveplot = ggplot(subset(PLPSG_sleep_stats_wider, loss > 0),
  aes(x = protective,
      fill = condition)) +
  ggtitle("Protective (Block 6 - Block 3)") +
    xlim(-0.15,.45) +
  geom_histogram(alpha = 0.5, position = "identity", bins = 30) + 
  scale_fill_manual(values=c("deepskyblue4", "indianred3"))

protectiveplot

x1 = PLPSG_sleep_stats_wider$protective[PLPSG_sleep_stats_wider$condition == "sleep" & PLPSG_sleep_stats_wider$loss > 0]
x2 = PLPSG_sleep_stats_wider$protective[PLPSG_sleep_stats_wider$condition == "wake" & PLPSG_sleep_stats_wider$loss > 0]
par(mfrow=c(2,1))
 
#Make the plot
par(mar=c(0,5,3,3))
hist(x1 , main="" , xlim=c(-0.2, 0.45), ylab="Count: sleep", xlab="", ylim=c(0,4) , xaxt="n", las=1 , col="deepskyblue4", breaks=12)
par(mar=c(5,5,0,3))
hist(x2 , main="" , xlim=c(-0.2, 0.45), ylab="Count: wake", xlab="Protective (Only for subjects Loss > 0)", ylim=c(4,0) , las=1 , col="indianred3"  , breaks=12)
```

### histogram plots of block1
```{r, message= FALSE}
x1 = PLPSG_sleep_stats_wider$block1[PLPSG_sleep_stats_wider$condition == "sleep"]
x2 = PLPSG_sleep_stats_wider$block1[PLPSG_sleep_stats_wider$condition == "wake"]
par(mfrow=c(2,1))
 
#Make the plot
par(mar=c(0,5,3,3))
hist(x1 , main="" , xlim=c(0, 1), ylab="Count: sleep", xlab="", ylim=c(0,8) , xaxt="n", las=1 , col="deepskyblue4", breaks=12)
par(mar=c(5,5,0,3))
hist(x2 , main="" , xlim=c(0, 1), ylab="Count: wake", xlab="Block 1 (Pretest)", ylim=c(8,0) , las=1 , col="indianred3"  , breaks=12)
```

### histogram plots of block3
```{r, message= FALSE}
x1 = PLPSG_sleep_stats_wider$block3[PLPSG_sleep_stats_wider$condition == "sleep"]
x2 = PLPSG_sleep_stats_wider$block3[PLPSG_sleep_stats_wider$condition == "wake"]
par(mfrow=c(2,1))
 
#Make the plot
par(mar=c(0,5,3,3))
hist(x1 , main="" , xlim=c(0, 1), ylab="Count: sleep", xlab="", ylim=c(0,6) , xaxt="n", las=1 , col="deepskyblue4", breaks=14)
par(mar=c(5,5,0,3))
hist(x2 , main="" , xlim=c(0, 1), ylab="Count: wake", xlab="Block 3 (Posttest1)", ylim=c(6,0) , las=1 , col="indianred3"  , breaks=14)
```

### histogram plots of block4
```{r, message= FALSE}
x1 = PLPSG_sleep_stats_wider$block4[PLPSG_sleep_stats_wider$condition == "sleep"]
x2 = PLPSG_sleep_stats_wider$block4[PLPSG_sleep_stats_wider$condition == "wake"]
par(mfrow=c(2,1))
 
#Make the plot
par(mar=c(0,5,3,3))
hist(x1 , main="" , xlim=c(0, 1), ylab="Count: sleep", xlab="", ylim=c(0,6) , xaxt="n", las=1 , col="deepskyblue4", breaks=14)
par(mar=c(5,5,0,3))
hist(x2 , main="" , xlim=c(0, 1), ylab="Count: wake", xlab="Block 4 (Posttest2)", ylim=c(6,0) , las=1 , col="indianred3"  , breaks=14)
```

### histogram plots of block5
```{r, message= FALSE}
x1 = PLPSG_sleep_stats_wider$block5[PLPSG_sleep_stats_wider$condition == "sleep"]
x2 = PLPSG_sleep_stats_wider$block5[PLPSG_sleep_stats_wider$condition == "wake"]
par(mfrow=c(2,1))
 
#Make the plot
par(mar=c(0,5,3,3))
hist(x1 , main="" , xlim=c(0, 1), ylab="Count: sleep", xlab="", ylim=c(0,8) , xaxt="n", las=1 , col="deepskyblue4", breaks=16)
par(mar=c(5,5,0,3))
hist(x2 , main="" , xlim=c(0, 1), ylab="Count: wake", xlab="Block 5 (Posttest3)", ylim=c(8,0) , las=1 , col="indianred3"  , breaks=16)
```



### histogram plots of block6
```{r, message= FALSE}
x1 = PLPSG_sleep_stats_wider$block6[PLPSG_sleep_stats_wider$condition == "sleep"]
x2 = PLPSG_sleep_stats_wider$block6[PLPSG_sleep_stats_wider$condition == "wake"]
par(mfrow=c(2,1))
 
#Make the plot
par(mar=c(0,5,3,3))
hist(x1 , main="" , xlim=c(0, 1), ylab="Count: sleep", xlab="", ylim=c(0,7) , xaxt="n", las=1 , col="deepskyblue4", breaks=12)
par(mar=c(5,5,0,3))
hist(x2 , main="" , xlim=c(0, 1), ylab="Count: wake", xlab="Block 6 (Posttest4)", ylim=c(7,0) , las=1 , col="indianred3"  , breaks=12)
```
