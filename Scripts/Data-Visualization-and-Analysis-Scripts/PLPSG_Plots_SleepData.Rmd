---
title: "PLPSG Plots of Sleep Data"
output: html_document
date: '2022-10-05'
---

### import packages
```{r, message=FALSE}
library(ggpubr) #needed for arranging multiple plots and making plots 
```

### import data files
```{r}
source("PLPSG_ImportData.R")
```


### visualize with histogram - amount of time spent in each stage of sleep 
```{r}
plot_N1 = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(y = as.numeric(N1), x = condition, na.rm = TRUE) + 
  ylab("N1 (minutes)") + 
  theme(axis.title.x = element_text(size = 9)) + 
  ylim(0, 60) +
  geom_violin() + 
  geom_dotplot(aes(color = ifelse(recovery > 0, "deepskyblue4", "indianred3"),
                   fill = ifelse(recovery > 0, "deepskyblue4", "indianred3")), 
               binaxis = 'y', stackdir = 'center', dotsize = 0.5) + 
  stat_summary(fun.data = "mean_cl_boot",
               geom = "crossbar",
               colour = "grey",
               width = 0.2) +
  scale_color_identity() +  # Ensures the color mapping is recognized
  scale_fill_identity()     # Ensures the fill mapping is recognized



plot_N2 = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(y = as.numeric(N2), x = condition,
      na.rm = TRUE) +
  ylab("N2 (minutes)") + 
  theme(axis.title.x = element_text(size=9)) + ylim(0,60) +
  geom_violin() + 
  geom_dotplot(aes(color = ifelse(recovery > 0, "deepskyblue4", "indianred3"),
                   fill = ifelse(recovery > 0, "deepskyblue4", "indianred3")), 
               binaxis = 'y', stackdir = 'center', dotsize = 0.5) + 
  stat_summary(fun.data = "mean_cl_boot",
               geom = "crossbar",
               colour = "grey",
               width = 0.2) +
  scale_color_identity() +  # Ensures the color mapping is recognized
  scale_fill_identity()     # Ensures the fill mapping is recognized

plot_N3 = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(y = as.numeric(N3), x = condition,
      na.rm = TRUE) +
  ylab("N3 (minutes)") + 
  theme(axis.title.x = element_text(size=9)) + ylim(0,60) +
  geom_violin() + 
  geom_dotplot(aes(color = ifelse(recovery > 0, "deepskyblue4", "indianred3"),
                   fill = ifelse(recovery > 0, "deepskyblue4", "indianred3")), 
               binaxis = 'y', stackdir = 'center', dotsize = 0.5) + 
  stat_summary(fun.data = "mean_cl_boot",
               geom = "crossbar",
               colour = "grey",
               width = 0.2) +
  scale_color_identity() +  # Ensures the color mapping is recognized
  scale_fill_identity()     # Ensures the fill mapping is recognized

plot_R = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(y = as.numeric(R), x = condition,
      na.rm = TRUE) +
  ylab("R (minutes)") + 
  theme(axis.title.x = element_text(size=9)) + ylim(0,60) +
  geom_violin() + 
  geom_dotplot(aes(color = ifelse(recovery > 0, "deepskyblue4", "indianred3"),
                   fill = ifelse(recovery > 0, "deepskyblue4", "indianred3")), 
               binaxis = 'y', stackdir = 'center', dotsize = 0.5) + 
  stat_summary(fun.data = "mean_cl_boot",
               geom = "crossbar",
               colour = "grey",
               width = 0.2) +
  scale_color_identity() +  # Ensures the color mapping is recognized
  scale_fill_identity()     # Ensures the fill mapping is recognized

figure <- ggarrange(plot_N1, plot_N2, plot_N3, plot_R,
                    labels = c("A", "B", "C", "D"),
                    ncol = 4, nrow = 1)
figure

```

### visualize with dot-plot - amount of time spent in each stage correlated with recovery (our measure of consolidation) 
```{r, message = FALSE}
plot_N1 = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(x = as.numeric(N1), y = recovery,
      na.rm = TRUE) + 
  xlab("N1 (minutes)") + 
  ylab("recovery") +
  theme(axis.title.x = element_text(size=9), axis.title.y = element_text(size=9)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)

plot_N2 = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(x = as.numeric(N2), y = recovery,
      na.rm = TRUE) +
  xlab("N2 (minutes)") + 
  ylab("recovery") +
  theme(axis.title.x = element_text(size=9), axis.title.y = element_text(size=9)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)

plot_N3 = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(x = as.numeric(N3), y = recovery,
      na.rm = TRUE) +
  xlab("N3 (minutes)") + 
  ylab("recovery") +
  theme(axis.title.x = element_text(size=9), axis.title.y = element_text(size=9)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)

plot_R = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(x = as.numeric(R), y = recovery,
      na.rm = TRUE) +
  xlab("R (minutes)") + 
  ylab("recovery") +
  theme(axis.title.x = element_text(size=9), axis.title.y = element_text(size=9)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)

figure <- ggarrange(plot_N1, plot_N2, plot_N3, plot_R,
                    labels = c("A", "B", "C", "D"),
                    ncol = 2, nrow = 2)
figure
```


### visualize with dot-plot - percent of time spent in each stage correlated with recovery (our measure of consolidation) 
```{r, message = FALSE}
plot_perN1 = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(x = as.numeric(perN1), y = recovery,
      na.rm = TRUE) + 
  xlab("N1 (percent)") + 
  ylab("recovery") +
  theme(axis.title.x = element_text(size=9), axis.title.y = element_text(size=9)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)

plot_perN2 = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(x = as.numeric(perN2), y = recovery,
      na.rm = TRUE) +
  xlab("N2 (percent)") + 
  ylab("recovery") +
  theme(axis.title.x = element_text(size=9), axis.title.y = element_text(size=9)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)

plot_perN3 = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(x = as.numeric(perN3), y = recovery,
      na.rm = TRUE) +
  xlab("N3 (percent)") + 
  ylab("recovery") +
  theme(axis.title.x = element_text(size=9), axis.title.y = element_text(size=9)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)

plot_perR = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(x = as.numeric(perR), y = recovery,
      na.rm = TRUE) +
  xlab("R (percent)") + 
  ylab("recovery") +
  theme(axis.title.x = element_text(size=9), axis.title.y = element_text(size=9)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)

figure <- ggarrange(plot_perN1, plot_perN2, plot_perN3, plot_perR,
                    labels = c("A", "B", "C", "D"),
                    ncol = 2, nrow = 2)
figure
```

### visualize with dot-plot - latency to each stage correlated with recovery (our measure of consolidation)
```{r, message = FALSE, warning = FALSE}
plot_latN1 = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(x = as.numeric(latN1), y = recovery,
      na.rm = TRUE) + 
  xlab("N1 latency (minutes)") + 
  ylab("recovery") +
  theme(axis.title.x = element_text(size=9), axis.title.y = element_text(size=9)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)

plot_latN2 = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(x = as.numeric(latN2), y = recovery,
      na.rm = TRUE) +
  xlab("N2 latency (minutes)") + 
  ylab("recovery") +
  theme(axis.title.x = element_text(size=9), axis.title.y = element_text(size=9)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)

plot_latN3 = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(x = as.numeric(latN3), y = recovery,
      na.rm = TRUE) +
  xlab("N3 latency (minutes)") + 
  ylab("recovery") +
  theme(axis.title.x = element_text(size=9), axis.title.y = element_text(size=9)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)

plot_latR = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(x = as.numeric(latR), y = recovery,
      na.rm = TRUE) +
  xlab("R latency (minutes)") + 
  ylab("recovery") +
  theme(axis.title.x = element_text(size=9), axis.title.y = element_text(size=9)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)

figure <- ggarrange(plot_latN1, plot_latN2, plot_latN3, plot_latR,
                    labels = c("A", "B", "C", "D"),
                    ncol = 2, nrow = 2)
figure
```

### visualize with dot-plot - WASO (wake after sleep onset) correlated with recovery (our measure of consolidation)
```{r, message = FALSE}
wasoplot = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(x = as.numeric(WASO), y = recovery,
      na.rm = TRUE) + 
  xlab("WASO (minutes)") + 
  ylab("recovery") +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)

wasoplot

#yeah.. this is definitely not what I would predict
```

### visualize with dot-plot - TST (total sleep time) correlated with recovery (our measure of consolidation)
```{r, message = FALSE}
tstplot = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(x = as.numeric(TST), y = recovery,
      na.rm = TRUE) + 
  xlab("TST (minutes)") + 
  ylab("recovery") +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)

tstplot
#this is also not what I would predict necessarily
```

### visualize with dot-plot - SE (sleep efficiency) correlated with recovery (our measure of consolidation)
```{r, message = FALSE}
seplot = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(x = as.numeric(SE), y = recovery,
      na.rm = TRUE) + 
  xlab("SE (percent)") + 
  ylab("recovery") +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)

seplot
#yeah.. this is not what I would predict either
```
### combine those three plots for summarizing 
```{r}
figure <- ggarrange(wasoplot, tstplot, seplot,
                    labels = c("A", "B", "C"),
                    ncol = 3, nrow = 1)
figure
```


### visualize with dot-plot - spindles correlated with recovery (our measure of consolidation )
```{r, message = FALSE}
ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(x = as.numeric(Spindles_N2andN3_F3_Count), y = recovery,
      na.rm = TRUE) + 
  xlab("Spindles_N2andN3_F3_Count") + 
  ylab("recovery") +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)

#yeah.. this is not what I would predict either
```

### visualize number of spindles detected during N2 and N3 
```{r}
plot_N2andN3_F3 = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(y = as.numeric(Spindles_N2andN3_F3_Count), x = condition, na.rm = TRUE) + 
  ylab("Spindles_N2andN3_F3_Count") + 
  theme(axis.title.x = element_text(size = 9)) + 
  geom_violin() + 
  geom_dotplot(aes(color = ifelse(recovery > 0, "deepskyblue4", "indianred3"),
                   fill = ifelse(recovery > 0, "deepskyblue4", "indianred3")), 
               binaxis = 'y', stackdir = 'center', dotsize = 0.5) + 
  stat_summary(fun.data = "mean_cl_boot",
               geom = "crossbar",
               colour = "grey",
               width = 0.2) +
  scale_color_identity() +  # Ensures the color mapping is recognized
  scale_fill_identity()     # Ensures the fill mapping is recognized

plot_N2andN3_F4 = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(y = as.numeric(Spindles_N2andN3_F4_Count), x = condition, na.rm = TRUE) + 
  ylab("Spindles_N2andN3_F4_Count") + 
  theme(axis.title.x = element_text(size = 9)) + 
  geom_violin() + 
  geom_dotplot(aes(color = ifelse(recovery > 0, "deepskyblue4", "indianred3"),
                   fill = ifelse(recovery > 0, "deepskyblue4", "indianred3")), 
               binaxis = 'y', stackdir = 'center', dotsize = 0.5) + 
  stat_summary(fun.data = "mean_cl_boot",
               geom = "crossbar",
               colour = "grey",
               width = 0.2) +
  scale_color_identity() +  # Ensures the color mapping is recognized
  scale_fill_identity()     # Ensures the fill mapping is recognized

plot_N2andN3_C3 = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(y = as.numeric(Spindles_N2andN3_C3_Count), x = condition, na.rm = TRUE) + 
  ylab("Spindles_N2andN3_C3_Count") + 
  theme(axis.title.x = element_text(size = 9)) + 
  geom_violin() + 
  geom_dotplot(aes(color = ifelse(recovery > 0, "deepskyblue4", "indianred3"),
                   fill = ifelse(recovery > 0, "deepskyblue4", "indianred3")), 
               binaxis = 'y', stackdir = 'center', dotsize = 0.5) + 
  stat_summary(fun.data = "mean_cl_boot",
               geom = "crossbar",
               colour = "grey",
               width = 0.2) +
  scale_color_identity() +  # Ensures the color mapping is recognized
  scale_fill_identity()     # Ensures the fill mapping is recognized

plot_N2andN3_C4 = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(y = as.numeric(Spindles_N2andN3_C4_Count), x = condition, na.rm = TRUE) + 
  ylab("Spindles_N2andN3_C4_Count") + 
  theme(axis.title.x = element_text(size = 9)) + 
  geom_violin() + 
  geom_dotplot(aes(color = ifelse(recovery > 0, "deepskyblue4", "indianred3"),
                   fill = ifelse(recovery > 0, "deepskyblue4", "indianred3")), 
               binaxis = 'y', stackdir = 'center', dotsize = 0.5) + 
  stat_summary(fun.data = "mean_cl_boot",
               geom = "crossbar",
               colour = "grey",
               width = 0.2) +
  scale_color_identity() +  # Ensures the color mapping is recognized
  scale_fill_identity()     # Ensures the fill mapping is recognized


figure <- ggarrange(plot_N2andN3_F3, plot_N2andN3_F4, plot_N2andN3_C3, plot_N2andN3_C4,
                    labels = c("A", "B", "C", "D"),
                    ncol = 4, nrow = 1)
figure


```

### visualize number of spindles detected during N2 
```{r}
plot_N2_F3 = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(y = as.numeric(Spindles_N2_F3_Count), x = condition, na.rm = TRUE) + 
  ylab("Spindles_N2_F3_Count") + 
  theme(axis.title.x = element_text(size = 9)) + 
  geom_violin() + 
  geom_dotplot(aes(color = ifelse(recovery > 0, "deepskyblue4", "indianred3"),
                   fill = ifelse(recovery > 0, "deepskyblue4", "indianred3")), 
               binaxis = 'y', stackdir = 'center', dotsize = 0.5) + 
  stat_summary(fun.data = "mean_cl_boot",
               geom = "crossbar",
               colour = "grey",
               width = 0.2) +
  scale_color_identity() +  # Ensures the color mapping is recognized
  scale_fill_identity()     # Ensures the fill mapping is recognized

plot_N2_F4 = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(y = as.numeric(Spindles_N2_F4_Count), x = condition, na.rm = TRUE) + 
  ylab("Spindles_N2_F4_Count") + 
  theme(axis.title.x = element_text(size = 9)) + 
  geom_violin() + 
  geom_dotplot(aes(color = ifelse(recovery > 0, "deepskyblue4", "indianred3"),
                   fill = ifelse(recovery > 0, "deepskyblue4", "indianred3")), 
               binaxis = 'y', stackdir = 'center', dotsize = 0.5) + 
  stat_summary(fun.data = "mean_cl_boot",
               geom = "crossbar",
               colour = "grey",
               width = 0.2) +
  scale_color_identity() +  # Ensures the color mapping is recognized
  scale_fill_identity()     # Ensures the fill mapping is recognized

plot_N2_C3 = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(y = as.numeric(Spindles_N2_C3_Count), x = condition, na.rm = TRUE) + 
  ylab("Spindles_N2_C3_Count") + 
  theme(axis.title.x = element_text(size = 9)) + 
  geom_violin() + 
  geom_dotplot(aes(color = ifelse(recovery > 0, "deepskyblue4", "indianred3"),
                   fill = ifelse(recovery > 0, "deepskyblue4", "indianred3")), 
               binaxis = 'y', stackdir = 'center', dotsize = 0.5) + 
  stat_summary(fun.data = "mean_cl_boot",
               geom = "crossbar",
               colour = "grey",
               width = 0.2) +
  scale_color_identity() +  # Ensures the color mapping is recognized
  scale_fill_identity()     # Ensures the fill mapping is recognized

plot_N2_C4 = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(y = as.numeric(Spindles_N2_C4_Count), x = condition, na.rm = TRUE) + 
  ylab("Spindles_N2_C4_Count") + 
  theme(axis.title.x = element_text(size = 9)) + 
  geom_violin() + 
  geom_dotplot(aes(color = ifelse(recovery > 0, "deepskyblue4", "indianred3"),
                   fill = ifelse(recovery > 0, "deepskyblue4", "indianred3")), 
               binaxis = 'y', stackdir = 'center', dotsize = 0.5) + 
  stat_summary(fun.data = "mean_cl_boot",
               geom = "crossbar",
               colour = "grey",
               width = 0.2) +
  scale_color_identity() +  # Ensures the color mapping is recognized
  scale_fill_identity()     # Ensures the fill mapping is recognized


figure <- ggarrange(plot_N2_F3, plot_N2_F4, plot_N2_C3, plot_N2_C4,
                    labels = c("A", "B", "C", "D"),
                    ncol = 4, nrow = 1)
figure


```

### visualize number of spindles detected during N3 
```{r}
plot_N3_F3 = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(y = as.numeric(Spindles_N3_F3_Count), x = condition, na.rm = TRUE) + 
  ylab("Spindles_N3_F3_Count") + 
  theme(axis.title.x = element_text(size = 9)) + 
  geom_violin() + 
  geom_dotplot(aes(color = ifelse(recovery > 0, "deepskyblue4", "indianred3"),
                   fill = ifelse(recovery > 0, "deepskyblue4", "indianred3")), 
               binaxis = 'y', stackdir = 'center', dotsize = 0.5) + 
  stat_summary(fun.data = "mean_cl_boot",
               geom = "crossbar",
               colour = "grey",
               width = 0.2) +
  scale_color_identity() +  # Ensures the color mapping is recognized
  scale_fill_identity()     # Ensures the fill mapping is recognized

plot_N3_F4 = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(y = as.numeric(Spindles_N3_F4_Count), x = condition, na.rm = TRUE) + 
  ylab("Spindles_N3_F4_Count") + 
  theme(axis.title.x = element_text(size = 9)) + 
  geom_violin() + 
  geom_dotplot(aes(color = ifelse(recovery > 0, "deepskyblue4", "indianred3"),
                   fill = ifelse(recovery > 0, "deepskyblue4", "indianred3")), 
               binaxis = 'y', stackdir = 'center', dotsize = 0.5) + 
  stat_summary(fun.data = "mean_cl_boot",
               geom = "crossbar",
               colour = "grey",
               width = 0.2) +
  scale_color_identity() +  # Ensures the color mapping is recognized
  scale_fill_identity()     # Ensures the fill mapping is recognized

plot_N3_C3 = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(y = as.numeric(Spindles_N3_C3_Count), x = condition, na.rm = TRUE) + 
  ylab("Spindles_N3_C3_Count") + 
  theme(axis.title.x = element_text(size = 9)) + 
  geom_violin() + 
  geom_dotplot(aes(color = ifelse(recovery > 0, "deepskyblue4", "indianred3"),
                   fill = ifelse(recovery > 0, "deepskyblue4", "indianred3")), 
               binaxis = 'y', stackdir = 'center', dotsize = 0.5) + 
  stat_summary(fun.data = "mean_cl_boot",
               geom = "crossbar",
               colour = "grey",
               width = 0.2) +
  scale_color_identity() +  # Ensures the color mapping is recognized
  scale_fill_identity()     # Ensures the fill mapping is recognized

plot_N3_C4 = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(y = as.numeric(Spindles_N3_C4_Count), x = condition, na.rm = TRUE) + 
  ylab("Spindles_N3_C4_Count") + 
  theme(axis.title.x = element_text(size = 9)) + 
  geom_violin() + 
  geom_dotplot(aes(color = ifelse(recovery > 0, "deepskyblue4", "indianred3"),
                   fill = ifelse(recovery > 0, "deepskyblue4", "indianred3")), 
               binaxis = 'y', stackdir = 'center', dotsize = 0.5) + 
  stat_summary(fun.data = "mean_cl_boot",
               geom = "crossbar",
               colour = "grey",
               width = 0.2) +
  scale_color_identity() +  # Ensures the color mapping is recognized
  scale_fill_identity()     # Ensures the fill mapping is recognized


figure <- ggarrange(plot_N3_F3, plot_N3_F4, plot_N3_C3, plot_N3_C4,
                    labels = c("A", "B", "C", "D"),
                    ncol = 4, nrow = 1)
figure


```





### visualize with dot-plot - amount of time spent in each stage correlated with maintenance
```{r, message = FALSE}
plot_N1 = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(x = as.numeric(N1), y = maintenance,
      na.rm = TRUE) + 
  xlab("N1 (minutes)") + 
  ylab("maintenance") +
  theme(axis.title.x = element_text(size=9), axis.title.y = element_text(size=9)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)

plot_N2 = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(x = as.numeric(N2), y = maintenance,
      na.rm = TRUE) +
  xlab("N2 (minutes)") + 
  ylab("maintenance") +
  theme(axis.title.x = element_text(size=9), axis.title.y = element_text(size=9)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)

plot_N3 = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(x = as.numeric(N3), y = maintenance,
      na.rm = TRUE) +
  xlab("N3 (minutes)") + 
  ylab("maintenance") +
  theme(axis.title.x = element_text(size=9), axis.title.y = element_text(size=9)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)

plot_R = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(x = as.numeric(R), y = maintenance,
      na.rm = TRUE) +
  xlab("R (minutes)") + 
  ylab("maintenance") +
  theme(axis.title.x = element_text(size=9), axis.title.y = element_text(size=9)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)

figure <- ggarrange(plot_N1, plot_N2, plot_N3, plot_R,
                    labels = c("A", "B", "C", "D"),
                    ncol = 2, nrow = 2)
figure
```

### visualize with dot-plot - percent of time spent in each stage correlated with maintenance
```{r, message = FALSE}
plot_perN1 = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(x = as.numeric(perN1), y = maintenance,
      na.rm = TRUE) + 
  xlab("N1 (percent)") + 
  ylab("maintenance") +
  theme(axis.title.x = element_text(size=9), axis.title.y = element_text(size=9)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)

plot_perN2 = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(x = as.numeric(perN2), y = maintenance,
      na.rm = TRUE) +
  xlab("N2 (percent)") + 
  ylab("maintenance") +
  theme(axis.title.x = element_text(size=9), axis.title.y = element_text(size=9)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)

plot_perN3 = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(x = as.numeric(perN3), y = maintenance,
      na.rm = TRUE) +
  xlab("N3 (percent)") + 
  ylab("maintenance") +
  theme(axis.title.x = element_text(size=9), axis.title.y = element_text(size=9)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)

plot_perR = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(x = as.numeric(perR), y = maintenance,
      na.rm = TRUE) +
  xlab("R (percent)") + 
  ylab("maintenance") +
  theme(axis.title.x = element_text(size=9), axis.title.y = element_text(size=9)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)

figure <- ggarrange(plot_perN1, plot_perN2, plot_perN3, plot_perR,
                    labels = c("A", "B", "C", "D"),
                    ncol = 2, nrow = 2)
figure
```

### visualize with dot-plot - latency to each stage correlated with maintenance
```{r}
plot_latN1 = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(x = as.numeric(latN1), y = maintenance,
      na.rm = TRUE) + 
  xlab("N1 (minutes)") + 
  ylab("maintenance") +
  theme(axis.title.x = element_text(size=9), axis.title.y = element_text(size=9)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)

plot_latN2 = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(x = as.numeric(latN2), y = maintenance,
      na.rm = TRUE) +
  xlab("N2 (minutes)") + 
  ylab("maintenance") +
  theme(axis.title.x = element_text(size=9), axis.title.y = element_text(size=9)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)

plot_latN3 = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(x = as.numeric(latN3), y = maintenance,
      na.rm = TRUE) +
  xlab("N3 (minutes)") + 
  ylab("maintenance") +
  theme(axis.title.x = element_text(size=9), axis.title.y = element_text(size=9)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)

plot_latR = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(x = as.numeric(latR), y = maintenance,
      na.rm = TRUE) +
  xlab("R (minutes)") + 
  ylab("maintenance") +
  theme(axis.title.x = element_text(size=9), axis.title.y = element_text(size=9)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)

figure <- ggarrange(plot_latN1, plot_latN2, plot_latN3, plot_latR,
                    labels = c("A", "B", "C", "D"),
                    ncol = 2, nrow = 2)
figure

```

### look at the correlation between block 1 and block 3
```{r}
#for both sleep and wake subjects together
ggplot(data = PLPSG_sleep_stats_wider) + 
  aes(x = as.numeric(block1), y = as.numeric(block3),
      na.rm = TRUE) + 
  xlab("block1") + 
  ylab("block3") +
  theme(axis.title.x = element_text(size=9), axis.title.y = element_text(size=9)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)

#for just sleep subjects
plot_sleep = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "sleep")) + 
  aes(x = as.numeric(block1), y = as.numeric(block3),
      na.rm = TRUE) + 
  xlab("block1") + 
  ylab("block3") +
  ggtitle("sleep") + 
  theme(axis.title.x = element_text(size=9), axis.title.y = element_text(size=9)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)

#for just wake subjects
plot_wake = ggplot(data = subset(PLPSG_sleep_stats_wider, condition == "wake")) + 
  aes(x = as.numeric(block1), y = as.numeric(block3),
      na.rm = TRUE) + 
  xlab("block1") + 
  ylab("block3") +
  ggtitle("wake") +
  theme(axis.title.x = element_text(size=9), axis.title.y = element_text(size=9)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)

figure <- ggarrange(plot_sleep, plot_wake,
                    labels = c("A", "B"),
                    ncol = 2, nrow = 1)
figure
```


